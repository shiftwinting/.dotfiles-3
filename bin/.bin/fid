#!/usr/bin/env python3

import argparse
import os
import subprocess
from pprint import pprint


def main():
	parser = argparse.ArgumentParser()
	parser.add_argument("accuracy")
	args = parser.parse_args()

	potential_duplicates = subprocess.check_output(
		["findimagedupes", "-R", "-q", "-t", args.accuracy, "."], text=True
	)

	for duplicateSet in potential_duplicates.strip().split("\n"):
		if not duplicateSet:
			continue
		current_folder = os.getcwd()
		duplicate_array = duplicateSet.split()
		pprint([i.replace(current_folder + "/", "") for i in duplicate_array])

		subprocess.call(["viewnior"] + duplicate_array)


if __name__ == "__main__":
	main()
